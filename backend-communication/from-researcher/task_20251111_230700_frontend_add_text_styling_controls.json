{
  "id": "task_20251111_230700_frontend_add_text_styling_controls",
  "from": "researcher",
  "to": "frontend",
  "timestamp": "2025-11-11T23:07:00.000Z",
  "type": "task",
  "priority": "high",
  "status": "pending",
  "subject": "IMPLEMENT: Add Text Styling Controls UI (Alignment, Font Size, Spacing)",
  "body": {
    "content": "## Context\n\nNow that we have dynamic text elements, we need to add UI controls so users can customize text styling:\n- Text alignment (left/center/right)\n- Font size (slider)\n- Letter spacing (slider)\n- Line spacing (slider)\n- Font style (italic/underline toggles)\n- Layer ordering (up/down buttons)\n\n**Current state:** Users can only edit text content, drag position, and resize width.\n\n**This task:** Add styling controls in the right panel that update the selected text element.\n\n**Depends on:**\n- task_20251111_230400 (assetSpec for constraints)\n- task_20251111_230500 (DraggableTextBox component)\n- task_20251111_230600 (State management with text_elements array)\n\n---\n\n## Task Breakdown\n\n### **Subtask 1: Update Right Panel to Show Selected Element**\n\n**File:** `src/components/InteractiveEditor.tsx`\n\n**Current panel shows:**\n```typescript\n<Card className=\"p-4 md:p-6\">\n  <h3 className=\"text-lg font-semibold mb-4\">Edit Your Text</h3>\n  \n  {/* Hardcoded textareas for headline, subheadline, CTA */}\n</Card>\n```\n\n**Update to show selected element:**\n```typescript\nimport { LayerOrderingControls } from './LayerOrderingControls';\n\n// Get selected element\nconst selectedElement = selectedElementId \n  ? textElements.find(el => el.tempId === selectedElementId)\n  : textElements[0];  // Default to first element if none selected\n\nif (!selectedElement) {\n  return (\n    <Card className=\"p-4 md:p-6\">\n      <p className=\"text-gray-500\">No text elements. Add one to get started.</p>\n    </Card>\n  );\n}\n\n<Card className=\"p-4 md:p-6\">\n  <div className=\"flex items-center justify-between mb-4\">\n    <h3 className=\"text-lg font-semibold\">Edit Text Element</h3>\n    \n    {/* Element selector dropdown */}\n    <Select\n      value={selectedElement.tempId}\n      onValueChange={setSelectedElementId}\n    >\n      {textElements.map(el => (\n        <SelectItem key={el.tempId} value={el.tempId}>\n          {el.label} {el.content ? `\"${el.content.substring(0, 20)}...\"` : '(empty)'}\n        </SelectItem>\n      ))}\n    </Select>\n  </div>\n  \n  {/* Rest of controls for selected element */}\n</Card>\n```\n\n---\n\n### **Subtask 2: Add Text Content Editor**\n\n```typescript\n{/* Text Content */}\n<div className=\"space-y-2\">\n  <Label htmlFor=\"text-content\" className=\"text-sm font-medium\">\n    {selectedElement.label} *\n  </Label>\n  <Textarea\n    id=\"text-content\"\n    value={selectedElement.content}\n    onChange={(e) => updateTextElementContent(selectedElement.tempId, e.target.value)}\n    placeholder={`Enter ${selectedElement.label.toLowerCase()}...`}\n    className=\"text-lg min-h-[3rem] resize-none\"\n    maxLength={selectedElement.constraints?.maxLength || 500}\n    rows={2}\n  />\n  <div className=\"text-xs text-muted-foreground text-right\">\n    {selectedElement.content.length}/{selectedElement.constraints?.maxLength || 500}\n  </div>\n</div>\n```\n\n---\n\n### **Subtask 3: Add Text Alignment Controls**\n\n```typescript\nimport { AlignLeft, AlignCenter, AlignRight, AlignJustify } from 'lucide-react';\nimport { ToggleGroup, ToggleGroupItem } from '@/components/ui/toggle-group';\n\n{/* Text Alignment */}\n<div className=\"space-y-2\">\n  <Label className=\"text-sm font-medium\">Text Alignment</Label>\n  <ToggleGroup\n    type=\"single\"\n    value={selectedElement.styling.textAlign}\n    onValueChange={(value) => {\n      if (value) {\n        updateTextElementStyling(selectedElement.tempId, { \n          textAlign: value as 'left' | 'center' | 'right' | 'justify' \n        });\n      }\n    }}\n    className=\"justify-start\"\n  >\n    <ToggleGroupItem value=\"left\" aria-label=\"Align left\">\n      <AlignLeft className=\"h-4 w-4\" />\n    </ToggleGroupItem>\n    <ToggleGroupItem value=\"center\" aria-label=\"Align center\">\n      <AlignCenter className=\"h-4 w-4\" />\n    </ToggleGroupItem>\n    <ToggleGroupItem value=\"right\" aria-label=\"Align right\">\n      <AlignRight className=\"h-4 w-4\" />\n    </ToggleGroupItem>\n    <ToggleGroupItem value=\"justify\" aria-label=\"Align justify\">\n      <AlignJustify className=\"h-4 w-4\" />\n    </ToggleGroupItem>\n  </ToggleGroup>\n</div>\n```\n\n---\n\n### **Subtask 4: Add Font Size Slider**\n\n```typescript\nimport { Slider } from '@/components/ui/slider';\n\n{/* Font Size */}\n<div className=\"space-y-2\">\n  <div className=\"flex items-center justify-between\">\n    <Label className=\"text-sm font-medium\">Font Size</Label>\n    <span className=\"text-sm text-gray-600\">{selectedElement.styling.fontSize}px</span>\n  </div>\n  <Slider\n    min={assetSpec.min_font_size}\n    max={assetSpec.max_font_size}\n    step={1}\n    value={[selectedElement.styling.fontSize]}\n    onValueChange={([value]) => {\n      updateTextElementStyling(selectedElement.tempId, { fontSize: value });\n    }}\n    className=\"w-full\"\n  />\n  <div className=\"flex justify-between text-xs text-gray-500\">\n    <span>{assetSpec.min_font_size}px</span>\n    <span>{assetSpec.max_font_size}px</span>\n  </div>\n</div>\n```\n\n---\n\n### **Subtask 5: Add Font Style Toggles**\n\n```typescript\nimport { Bold, Italic, Underline } from 'lucide-react';\nimport { Toggle } from '@/components/ui/toggle';\n\n{/* Font Style */}\n<div className=\"space-y-2\">\n  <Label className=\"text-sm font-medium\">Font Style</Label>\n  <div className=\"flex gap-2\">\n    <Toggle\n      pressed={selectedElement.styling.fontWeight === 'bold'}\n      onPressedChange={(pressed) => {\n        updateTextElementStyling(selectedElement.tempId, {\n          fontWeight: pressed ? 'bold' : 'normal'\n        });\n      }}\n      aria-label=\"Toggle bold\"\n    >\n      <Bold className=\"h-4 w-4\" />\n    </Toggle>\n    \n    <Toggle\n      pressed={selectedElement.styling.italic}\n      onPressedChange={(pressed) => {\n        updateTextElementStyling(selectedElement.tempId, { italic: pressed });\n      }}\n      aria-label=\"Toggle italic\"\n    >\n      <Italic className=\"h-4 w-4\" />\n    </Toggle>\n    \n    <Toggle\n      pressed={selectedElement.styling.underline}\n      onPressedChange={(pressed) => {\n        updateTextElementStyling(selectedElement.tempId, { underline: pressed });\n      }}\n      aria-label=\"Toggle underline\"\n    >\n      <Underline className=\"h-4 w-4\" />\n    </Toggle>\n  </div>\n</div>\n```\n\n---\n\n### **Subtask 6: Add Spacing Controls**\n\n```typescript\n{/* Letter Spacing */}\n<div className=\"space-y-2\">\n  <div className=\"flex items-center justify-between\">\n    <Label className=\"text-sm font-medium\">Letter Spacing</Label>\n    <span className=\"text-sm text-gray-600\">{selectedElement.styling.letterSpacing}px</span>\n  </div>\n  <Slider\n    min={assetSpec.min_letter_spacing}\n    max={assetSpec.max_letter_spacing}\n    step={1}\n    value={[selectedElement.styling.letterSpacing]}\n    onValueChange={([value]) => {\n      updateTextElementStyling(selectedElement.tempId, { letterSpacing: value });\n    }}\n    className=\"w-full\"\n  />\n  <div className=\"flex justify-between text-xs text-gray-500\">\n    <span>{assetSpec.min_letter_spacing}px (tight)</span>\n    <span>{assetSpec.max_letter_spacing}px (loose)</span>\n  </div>\n</div>\n\n{/* Line Spacing */}\n<div className=\"space-y-2\">\n  <div className=\"flex items-center justify-between\">\n    <Label className=\"text-sm font-medium\">Line Spacing</Label>\n    <span className=\"text-sm text-gray-600\">{selectedElement.styling.lineSpacing}px</span>\n  </div>\n  <Slider\n    min={assetSpec.min_line_spacing}\n    max={assetSpec.max_line_spacing}\n    step={1}\n    value={[selectedElement.styling.lineSpacing]}\n    onValueChange={([value]) => {\n      updateTextElementStyling(selectedElement.tempId, { lineSpacing: value });\n    }}\n    className=\"w-full\"\n  />\n  <div className=\"flex justify-between text-xs text-gray-500\">\n    <span>{assetSpec.min_line_spacing}px (tight)</span>\n    <span>{assetSpec.max_line_spacing}px (loose)</span>\n  </div>\n</div>\n```\n\n---\n\n### **Subtask 7: Add Layer Ordering Controls**\n\n```typescript\nimport { LayerOrderingControls } from './LayerOrderingControls';\n\n{/* Layer Ordering */}\n<div className=\"space-y-2\">\n  <Label className=\"text-sm font-medium\">Layer Order</Label>\n  <LayerOrderingControls\n    currentOrder={selectedElement.displayOrder}\n    totalLayers={textElements.length}\n    onMoveForward={() => moveElementForward(selectedElement.tempId)}\n    onMoveBackward={() => moveElementBackward(selectedElement.tempId)}\n    onMoveToFront={() => moveElementToFront(selectedElement.tempId)}\n    onMoveToBack={() => moveElementToBack(selectedElement.tempId)}\n  />\n</div>\n```\n\n---\n\n### **Subtask 8: Add Visual Preview of Changes**\n\n**Highlight selected element in canvas:**\n\n```typescript\n// In DraggableTextBox component, add selected prop\ninterface DraggableTextBoxProps {\n  // ... existing props\n  isSelected?: boolean;  // ⭐ NEW\n}\n\n// Update className\nclassName={`draggable-text ${\n  isDragging ? 'dragging' : ''\n} ${\n  isResizing ? 'resizing' : ''\n} ${\n  isSelected ? 'selected' : ''  // ⭐ NEW\n}`}\n\n// Add CSS for selected state\n<style>{`\n  .draggable-text.selected {\n    border: 2px solid #3b82f6 !important;\n    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);\n  }\n`}</style>\n```\n\n**Pass isSelected to DraggableTextBox:**\n```typescript\n<DraggableTextBox\n  key={element.tempId}\n  textElement={element}\n  isSelected={selectedElementId === element.tempId}  // ⭐ NEW\n  // ... other props\n/>\n```\n\n---\n\n### **Subtask 9: Keep Existing Color Controls**\n\n**Keep the auto text color toggle and manual color pickers:**\n```typescript\n{/* Text Color Control */}\n<div className=\"space-y-2\">\n  <Label className=\"text-sm font-medium\">Text Color</Label>\n  <div className=\"flex items-center gap-3\">\n    <button\n      onClick={() => setAutoTextColor(!autoTextColor)}\n      className={`flex items-center gap-2 px-3 py-2 rounded-lg border-2 transition-colors ${\n        autoTextColor\n          ? 'border-blue-500 bg-blue-50'\n          : 'border-gray-300 bg-white'\n      }`}\n    >\n      <div className={`w-4 h-4 rounded ${\n        autoTextColor ? 'bg-blue-500' : 'bg-gray-300'\n      }`} />\n      <span className=\"text-sm\">Auto (based on background)</span>\n    </button>\n  </div>\n\n  {/* Manual color pickers */}\n  {!autoTextColor && (\n    <div className=\"flex gap-2 pt-2\">\n      <button\n        onClick={() => updateTextElementStyling(selectedElement.tempId, { color: '#000000' })}\n        className={`w-8 h-8 rounded border-2 bg-black ${\n          selectedElement.styling.color === '#000000' ? 'border-blue-500' : 'border-gray-300'\n        }`}\n      />\n      <button\n        onClick={() => updateTextElementStyling(selectedElement.tempId, { color: '#FFFFFF' })}\n        className={`w-8 h-8 rounded border-2 bg-white ${\n          selectedElement.styling.color === '#FFFFFF' ? 'border-blue-500' : 'border-gray-300'\n        }`}\n      />\n    </div>\n  )}\n</div>\n```\n\n---\n\n## Success Criteria\n\n- [ ] Right panel shows controls for selected text element\n- [ ] Element selector dropdown works\n- [ ] Text content editor updates selected element\n- [ ] Text alignment controls (left/center/right/justify) work\n- [ ] Font size slider uses assetSpec constraints\n- [ ] Font style toggles (bold/italic/underline) work\n- [ ] Letter spacing slider works\n- [ ] Line spacing slider works\n- [ ] Layer ordering controls integrated\n- [ ] Selected element highlighted in canvas\n- [ ] Color controls work\n- [ ] Changes reflected in real-time in canvas\n- [ ] No TypeScript errors\n\n---\n\n## Testing Checklist\n\n```bash\n# Test styling controls\n1. Open InteractiveEditor\n2. Select headline element\n3. Change text alignment to \"left\" - verify text aligns left in canvas\n4. Change font size slider - verify text size changes in canvas\n5. Toggle italic - verify text becomes italic\n6. Toggle underline - verify text gets underlined\n7. Adjust letter spacing - verify spacing changes\n8. Adjust line spacing (with multi-line text) - verify line height changes\n9. Use layer ordering buttons - verify element moves forward/backward\n10. Select different element - verify controls update\n```\n\n---\n\n## UI Layout\n\n```\n┌─────────────────────────────────┐\n│ Edit Text Element        [▼]   │  ← Dropdown to select element\n├─────────────────────────────────┤\n│ [Textarea for content]          │\n│ Character count: 23/100         │\n├─────────────────────────────────┤\n│ Text Alignment                  │\n│ [L] [C] [R] [J]                 │  ← Toggle group\n├─────────────────────────────────┤\n│ Font Size            153px      │\n│ [========●==========]           │  ← Slider\n│ 20px              300px         │\n├─────────────────────────────────┤\n│ Font Style                      │\n│ [B] [I] [U]                     │  ← Toggles\n├─────────────────────────────────┤\n│ Letter Spacing        2px       │\n│ [====●==============]           │\n│ -5px (tight)      20px (loose)  │\n├─────────────────────────────────┤\n│ Line Spacing         15px       │\n│ [======●============]           │\n│ 0px (tight)       50px (loose)  │\n├─────────────────────────────────┤\n│ Layer Order                     │\n│ Layer 2 of 3  [⬇][↓][↑][⬆]     │  ← Layer controls\n├─────────────────────────────────┤\n│ Text Color                      │\n│ ○ Auto (based on background)   │\n│ [Black] [White]                 │\n└─────────────────────────────────┘\n```\n\n---\n\n## Notes for Frontend\n\n**Can use subagents for:**\n- Creating alignment controls (1 subagent)\n- Creating sliders (1 subagent)\n- Creating font style toggles (1 subagent)\n- Integrating layer controls (1 subagent)\n\n**Depends on:**\n- Task 1 (assetSpec for slider ranges)\n- Task 2 (LayerOrderingControls component)\n- Task 3 (text_elements array and update functions)\n\n---\n\n## Estimated Time\n\n**Total: 25 minutes**\n- Element selector: 5 minutes\n- Alignment controls: 5 minutes\n- Sliders (font size, letter, line spacing): 10 minutes\n- Font style toggles: 3 minutes\n- Layer ordering integration: 2 minutes",
    "attachments": [],
    "verification_checklist": [
      "Right panel shows selected element controls",
      "Element selector dropdown works",
      "Text content editor works",
      "Alignment controls work",
      "Font size slider works with constraints",
      "Font style toggles work",
      "Letter spacing slider works",
      "Line spacing slider works",
      "Layer ordering controls work",
      "Selected element highlighted",
      "Color controls work",
      "Real-time preview in canvas",
      "No TypeScript errors"
    ]
  },
  "execution": {
    "estimated_time": "25 minutes",
    "timeout": 35,
    "complexity": "medium"
  },
  "metadata": {
    "related_files": [
      "src/components/InteractiveEditor.tsx",
      "src/components/DraggableTextBox.tsx",
      "src/components/LayerOrderingControls.tsx"
    ],
    "api_endpoints": [],
    "requires_testing": true,
    "depends_on": [
      "task_20251111_230400_frontend_asset_type_wizard_flow",
      "task_20251111_230500_frontend_create_draggable_text_box_component",
      "task_20251111_230600_frontend_refactor_interactive_editor_state"
    ]
  }
}
